\hypertarget{classhwm_1_1command_1_1parser_1_1_command_parser}{\section{hwm.\-command.\-parser.\-Command\-Parser Class Reference}
\label{classhwm_1_1command_1_1parser_1_1_command_parser}\index{hwm.\-command.\-parser.\-Command\-Parser@{hwm.\-command.\-parser.\-Command\-Parser}}
}


Processes all commands received by the hardware manager.  


\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
def \hyperlink{classhwm_1_1command_1_1parser_1_1_command_parser_a397d835d19f30cbc0af81e4727c242ac}{\-\_\-\-\_\-init\-\_\-\-\_\-}
\begin{DoxyCompactList}\small\item\em Sets up the command parser instance. \end{DoxyCompactList}\item 
def \hyperlink{classhwm_1_1command_1_1parser_1_1_command_parser_a82b1c3fed48de051083d7d56c1dc1d45}{system\-\_\-command\-\_\-handlers}
\begin{DoxyCompactList}\small\item\em Provides access to the loaded system command handlers. \end{DoxyCompactList}\item 
def \hyperlink{classhwm_1_1command_1_1parser_1_1_command_parser_abba503c449762e5c3896b609dad0c575}{parse\-\_\-command}
\begin{DoxyCompactList}\small\item\em Processes all commands received by the ground station. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
\hypertarget{classhwm_1_1command_1_1parser_1_1_command_parser_a711f818525889f03cb592637513a8104}{{\bfseries system\-\_\-handlers}}\label{classhwm_1_1command_1_1parser_1_1_command_parser_a711f818525889f03cb592637513a8104}

\item 
\hypertarget{classhwm_1_1command_1_1parser_1_1_command_parser_a27ae7cf7b666ef918a45706cc2229ba0}{{\bfseries permission\-\_\-manager}}\label{classhwm_1_1command_1_1parser_1_1_command_parser_a27ae7cf7b666ef918a45706cc2229ba0}

\item 
\hypertarget{classhwm_1_1command_1_1parser_1_1_command_parser_a2f277481c45b26514976252880c8f6a8}{{\bfseries pipeline\-\_\-manager}}\label{classhwm_1_1command_1_1parser_1_1_command_parser_a2f277481c45b26514976252880c8f6a8}

\item 
\hypertarget{classhwm_1_1command_1_1parser_1_1_command_parser_a2f7eb4e83f80e3aca36e547f8b045e13}{{\bfseries session\-\_\-coordinator}}\label{classhwm_1_1command_1_1parser_1_1_command_parser_a2f7eb4e83f80e3aca36e547f8b045e13}

\end{DoxyCompactItemize}
\subsection*{Private Member Functions}
\begin{DoxyCompactItemize}
\item 
def \hyperlink{classhwm_1_1command_1_1parser_1_1_command_parser_a47cef501a1476ff0057682e61a366fd6}{\-\_\-load\-\_\-permissions}
\begin{DoxyCompactList}\small\item\em Loads the user's permissions, if required. \end{DoxyCompactList}\item 
def \hyperlink{classhwm_1_1command_1_1parser_1_1_command_parser_aa73d2febe867798267139571ddad26d9}{\-\_\-run\-\_\-command}
\begin{DoxyCompactList}\small\item\em Executes the command after it has been validated. \end{DoxyCompactList}\item 
def \hyperlink{classhwm_1_1command_1_1parser_1_1_command_parser_a40cc95046bc15292efea3cdaf846353c}{\-\_\-command\-\_\-complete}
\begin{DoxyCompactList}\small\item\em Builds a complete response for the successful command. \end{DoxyCompactList}\item 
def \hyperlink{classhwm_1_1command_1_1parser_1_1_command_parser_a5e7cadb7dd0a59464f315a8de45be9b1}{\-\_\-command\-\_\-error}
\begin{DoxyCompactList}\small\item\em Generates an appropriate error response for the command failure. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
Processes all commands received by the hardware manager. 

This class parses and performs validations on received commands, delegating them to the appropriate command handler. 

\subsection{Constructor \& Destructor Documentation}
\hypertarget{classhwm_1_1command_1_1parser_1_1_command_parser_a397d835d19f30cbc0af81e4727c242ac}{\index{hwm\-::command\-::parser\-::\-Command\-Parser@{hwm\-::command\-::parser\-::\-Command\-Parser}!\-\_\-\-\_\-init\-\_\-\-\_\-@{\-\_\-\-\_\-init\-\_\-\-\_\-}}
\index{\-\_\-\-\_\-init\-\_\-\-\_\-@{\-\_\-\-\_\-init\-\_\-\-\_\-}!hwm::command::parser::CommandParser@{hwm\-::command\-::parser\-::\-Command\-Parser}}
\subsubsection[{\-\_\-\-\_\-init\-\_\-\-\_\-}]{\setlength{\rightskip}{0pt plus 5cm}def hwm.\-command.\-parser.\-Command\-Parser.\-\_\-\-\_\-init\-\_\-\-\_\- (
\begin{DoxyParamCaption}
\item[{}]{self, }
\item[{}]{system\-\_\-command\-\_\-handlers, }
\item[{}]{permission\-\_\-manager}
\end{DoxyParamCaption}
)}}\label{classhwm_1_1command_1_1parser_1_1_command_parser_a397d835d19f30cbc0af81e4727c242ac}


Sets up the command parser instance. 


\begin{DoxyParams}{Parameters}
{\em system\-\_\-command\-\_\-handlers} & A array containing references to all of the system command handlers. If a command's destination field references an element in this dictionary, that command handler will be used. Otherwise, it will be delegated to a device command handler. \\
\hline
{\em permission\-\_\-manager} & A reference to the permissions manager instance that will be used to determine if a user has the permissions to execute a given command.\\
\hline
\end{DoxyParams}
\begin{DoxyNote}{Note}
This class requires that a Session\-Coordinator instance be initialized with an instance of this class before it can parse commands. It needs the session coordinator to load the user's active sessions, and the session coordinator needs this class so that it can pass it to newly created sessions for their setup commands. 

This class requires that a Pipeline\-Manager instance be initialized with an instance of this class before it can parse device commands. This is required so that it can relay device commands to the specified device. 
\end{DoxyNote}


\subsection{Member Function Documentation}
\hypertarget{classhwm_1_1command_1_1parser_1_1_command_parser_a40cc95046bc15292efea3cdaf846353c}{\index{hwm\-::command\-::parser\-::\-Command\-Parser@{hwm\-::command\-::parser\-::\-Command\-Parser}!\-\_\-command\-\_\-complete@{\-\_\-command\-\_\-complete}}
\index{\-\_\-command\-\_\-complete@{\-\_\-command\-\_\-complete}!hwm::command::parser::CommandParser@{hwm\-::command\-::parser\-::\-Command\-Parser}}
\subsubsection[{\-\_\-command\-\_\-complete}]{\setlength{\rightskip}{0pt plus 5cm}def hwm.\-command.\-parser.\-Command\-Parser.\-\_\-command\-\_\-complete (
\begin{DoxyParamCaption}
\item[{}]{self, }
\item[{}]{command\-\_\-results, }
\item[{}]{successful\-\_\-command}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [private]}}}\label{classhwm_1_1command_1_1parser_1_1_command_parser_a40cc95046bc15292efea3cdaf846353c}


Builds a complete response for the successful command. 

\begin{DoxyVerb} This callback generates a successful command response. It is called after the command has been executed in a new
 thread. 
\end{DoxyVerb}



\begin{DoxyParams}{Parameters}
{\em command\-\_\-results} & A dictionary containing additional data to embed with the command response (in the \char`\"{}result\char`\"{} field of the J\-S\-O\-N response). This is returned by the individual command functions in the command handlers. \\
\hline
{\em successful\-\_\-command} & The command that just completed. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Returns the constructed command response dictionary. This dictionary is fed into callbacks waiting for the command results. 
\end{DoxyReturn}
\hypertarget{classhwm_1_1command_1_1parser_1_1_command_parser_a5e7cadb7dd0a59464f315a8de45be9b1}{\index{hwm\-::command\-::parser\-::\-Command\-Parser@{hwm\-::command\-::parser\-::\-Command\-Parser}!\-\_\-command\-\_\-error@{\-\_\-command\-\_\-error}}
\index{\-\_\-command\-\_\-error@{\-\_\-command\-\_\-error}!hwm::command::parser::CommandParser@{hwm\-::command\-::parser\-::\-Command\-Parser}}
\subsubsection[{\-\_\-command\-\_\-error}]{\setlength{\rightskip}{0pt plus 5cm}def hwm.\-command.\-parser.\-Command\-Parser.\-\_\-command\-\_\-error (
\begin{DoxyParamCaption}
\item[{}]{self, }
\item[{}]{failure, }
\item[{}]{failed\-\_\-command}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [private]}}}\label{classhwm_1_1command_1_1parser_1_1_command_parser_a5e7cadb7dd0a59464f315a8de45be9b1}


Generates an appropriate error response for the command failure. 

\begin{DoxyVerb} This errback generates an error response for the indicated failure, which is then loaded into a CommandFailed
 exception and re-raised. If the incoming failure is wrapping an exception of type CommandError then it may contain a 
 dictionary with additional information about the error.
\end{DoxyVerb}



\begin{DoxyExceptions}{Exceptions}
{\em Raises} & a \hyperlink{classhwm_1_1command_1_1parser_1_1_command_failed}{Command\-Failed} exception which contains information about the failure.\\
\hline
\end{DoxyExceptions}

\begin{DoxyParams}{Parameters}
{\em failure} & The Failure object representing the error. \\
\hline
{\em failed\-\_\-command} & The Command object of the failed command. \\
\hline
\end{DoxyParams}
\hypertarget{classhwm_1_1command_1_1parser_1_1_command_parser_a47cef501a1476ff0057682e61a366fd6}{\index{hwm\-::command\-::parser\-::\-Command\-Parser@{hwm\-::command\-::parser\-::\-Command\-Parser}!\-\_\-load\-\_\-permissions@{\-\_\-load\-\_\-permissions}}
\index{\-\_\-load\-\_\-permissions@{\-\_\-load\-\_\-permissions}!hwm::command::parser::CommandParser@{hwm\-::command\-::parser\-::\-Command\-Parser}}
\subsubsection[{\-\_\-load\-\_\-permissions}]{\setlength{\rightskip}{0pt plus 5cm}def hwm.\-command.\-parser.\-Command\-Parser.\-\_\-load\-\_\-permissions (
\begin{DoxyParamCaption}
\item[{}]{self, }
\item[{}]{validation\-\_\-results, }
\item[{}]{valid\-\_\-command}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [private]}}}\label{classhwm_1_1command_1_1parser_1_1_command_parser_a47cef501a1476ff0057682e61a366fd6}


Loads the user's permissions, if required. 

\begin{DoxyVerb} This callback runs after the command has been validated and is responsible for loading a user's permissions to make
 sure that the user has permission to execute the command. If the command is being executed in kernel mode, then this
 step will be skipped and a pre-fired deferred will be returned to continue the execution process.
\end{DoxyVerb}



\begin{DoxyExceptions}{Exceptions}
{\em This} & callback may throw several exceptions indicating errors about the command. These exceptions will automatically be picked up by the errback chain on the parent deferred.\\
\hline
\end{DoxyExceptions}

\begin{DoxyParams}{Parameters}
{\em validation\-\_\-results} & The validation results. Always true (because this is a callback and not an errback). \\
\hline
{\em valid\-\_\-command} & The Command object being executed. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Returns a deferred that will eventually be fired with the user's command execution permissions (or None if the command is being run in kernel mode). 
\end{DoxyReturn}
\hypertarget{classhwm_1_1command_1_1parser_1_1_command_parser_aa73d2febe867798267139571ddad26d9}{\index{hwm\-::command\-::parser\-::\-Command\-Parser@{hwm\-::command\-::parser\-::\-Command\-Parser}!\-\_\-run\-\_\-command@{\-\_\-run\-\_\-command}}
\index{\-\_\-run\-\_\-command@{\-\_\-run\-\_\-command}!hwm::command::parser::CommandParser@{hwm\-::command\-::parser\-::\-Command\-Parser}}
\subsubsection[{\-\_\-run\-\_\-command}]{\setlength{\rightskip}{0pt plus 5cm}def hwm.\-command.\-parser.\-Command\-Parser.\-\_\-run\-\_\-command (
\begin{DoxyParamCaption}
\item[{}]{self, }
\item[{}]{user\-\_\-permissions, }
\item[{}]{valid\-\_\-command}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [private]}}}\label{classhwm_1_1command_1_1parser_1_1_command_parser_aa73d2febe867798267139571ddad26d9}


Executes the command after it has been validated. 

\begin{DoxyVerb} This callback sends the command to it's specified destination after it has been validated by previous callbacks. It
 will eventually return the command response via a deferred.
\end{DoxyVerb}



\begin{DoxyExceptions}{Exceptions}
{\em May} & throw Command\-Error and other exceptions indicating that the command has failed. A subsequent errback in the main command deferred chain will automatically handle all command errors.\\
\hline
\end{DoxyExceptions}

\begin{DoxyParams}{Parameters}
{\em user\-\_\-permissions} & A dictionary containing the user's permissions. If the command is being running in kernel mode, this will just be None. \\
\hline
{\em valid\-\_\-command} & The Command object for the currently executing command. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Returns a deferred that will eventually be fired with the results of the command execution. 
\end{DoxyReturn}
\hypertarget{classhwm_1_1command_1_1parser_1_1_command_parser_abba503c449762e5c3896b609dad0c575}{\index{hwm\-::command\-::parser\-::\-Command\-Parser@{hwm\-::command\-::parser\-::\-Command\-Parser}!parse\-\_\-command@{parse\-\_\-command}}
\index{parse\-\_\-command@{parse\-\_\-command}!hwm::command::parser::CommandParser@{hwm\-::command\-::parser\-::\-Command\-Parser}}
\subsubsection[{parse\-\_\-command}]{\setlength{\rightskip}{0pt plus 5cm}def hwm.\-command.\-parser.\-Command\-Parser.\-parse\-\_\-command (
\begin{DoxyParamCaption}
\item[{}]{self, }
\item[{}]{raw\-\_\-command, }
\item[{}]{user\-\_\-id = {\ttfamily None}, }
\item[{}]{kernel\-\_\-mode = {\ttfamily False}}
\end{DoxyParamCaption}
)}}\label{classhwm_1_1command_1_1parser_1_1_command_parser_abba503c449762e5c3896b609dad0c575}


Processes all commands received by the ground station. 

\begin{DoxyVerb} When a raw command is passed to this function, it performs the following operations via a series of callbacks:
 * Constructs a new Command and validates it against that command's schema
 * Verifies that the indicated command exists
 * Checks that the user can execute the command
 * Executes the command in a new thread
 * Returns a deferred that will be fired with the results of the command

 Some of these steps may be skipped depending on the type of command. For example, kernel level commands skip the 
 permission checking phase.
\end{DoxyVerb}


\begin{DoxyNote}{Note}
In the event of an error with the command (e.\-g. invalid schema or permission error), the error will be logged and an error response will be returned via the returned deerred's errback chain. 

The callback/errback chain for the deferred returned from this function will be fired with a dictionary containing the results of the command. In the event of an error, these results can be accessed using the returned Failure like so\-: Failure.\-value.\-results\mbox{[}'response'\mbox{]}. In the event of a success, these results can be accessed via the 'response' key of the callback parameter. The calling module is responsible for converting this dictionary into an appropriate format.
\end{DoxyNote}

\begin{DoxyParams}{Parameters}
{\em raw\-\_\-command} & A raw command containing metadata about the command in an arbitrary format (specific Command classes are responsible for parsing different formats). \\
\hline
{\em user\-\_\-id} & The user's I\-D for the purpose of loading command execution settings. If set, this probably came from the user's S\-S\-L certificate or reservation schedule. \\
\hline
{\em kernel\-\_\-mode} & Indicates if the command should be run in kernel mode. That is, whether permission and session restrictions should be ignored. This is done, for example, when pipeline setup commands get run as a new session is being setup. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Returns the results of the command in a dictionary using a deferred. May be the output of the command or a Failure (containing details about the failure) in the event of an error. 
\end{DoxyReturn}
\hypertarget{classhwm_1_1command_1_1parser_1_1_command_parser_a82b1c3fed48de051083d7d56c1dc1d45}{\index{hwm\-::command\-::parser\-::\-Command\-Parser@{hwm\-::command\-::parser\-::\-Command\-Parser}!system\-\_\-command\-\_\-handlers@{system\-\_\-command\-\_\-handlers}}
\index{system\-\_\-command\-\_\-handlers@{system\-\_\-command\-\_\-handlers}!hwm::command::parser::CommandParser@{hwm\-::command\-::parser\-::\-Command\-Parser}}
\subsubsection[{system\-\_\-command\-\_\-handlers}]{\setlength{\rightskip}{0pt plus 5cm}def hwm.\-command.\-parser.\-Command\-Parser.\-system\-\_\-command\-\_\-handlers (
\begin{DoxyParamCaption}
\item[{}]{self}
\end{DoxyParamCaption}
)}}\label{classhwm_1_1command_1_1parser_1_1_command_parser_a82b1c3fed48de051083d7d56c1dc1d45}


Provides access to the loaded system command handlers. 

\begin{DoxyReturn}{Returns}
Returns the dictionary containing references to the available system command handlers. 
\end{DoxyReturn}


The documentation for this class was generated from the following file\-:\begin{DoxyCompactItemize}
\item 
hwm/command/parser.\-py\end{DoxyCompactItemize}
